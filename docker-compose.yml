version: '3'
services:
  prisma:
    network_mode: 'host'
    image: prismagraphql/prisma:1.34
    restart: always
    ports:
      - '4466:4466'
    environment:
      PRISMA_CONFIG: |
        port: 4466
        # uncomment the next line and provide the env var PRISMA_MANAGEMENT_API_SECRET=my-secret to activate cluster security
        # managementApiSecret: my-secret
        databases:
          default:
            connector: mongo
            uri: 'mongodb://localhost:27017'
  client:
    network_mode: 'host'
    build:
      context: './'
      dockerfile: './client.Dockerfile'
    environment:
      REACT_APP_API_ENDPOINT: $API_ENDPOINT
  server:
    network_mode: 'host'
    build:
      context: './'
      dockerfile: './server.Dockerfile'
  prisma_dev:
    image: prismagraphql/prisma:1.34
    restart: always
    ports:
      - '4466:4466'
    environment:
      PRISMA_CONFIG: |
        port: 4466
        # uncomment the next line and provide the env var PRISMA_MANAGEMENT_API_SECRET=my-secret to activate cluster security
        # managementApiSecret: my-secret
        databases:
          default:
            connector: mongo
            uri: 'mongodb+srv://root:root@testdb-6kjha.mongodb.net'
